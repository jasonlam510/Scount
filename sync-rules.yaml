bucket_definitions:
  user:
    # User's personal data bucket
    parameters: SELECT request.user_id() as user_id
    data:
      # User's own profile
      - SELECT * FROM public.profiles WHERE id = bucket.user_id
  
  groups:
    # Groups the user has access to (as members)
    parameters: SELECT group_id FROM public.group_members WHERE user_id = request.user_id()
    data:
      # Group details for groups user participates in
      - SELECT * FROM public.groups WHERE id = bucket.group_id AND is_deleted = false
      # All participants in user's groups
      - SELECT * FROM public.group_members WHERE group_id = bucket.group_id